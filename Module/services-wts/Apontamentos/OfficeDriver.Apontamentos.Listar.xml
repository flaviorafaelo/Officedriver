<?xml version="1.0"?>
<root>
  <OBJECT NAME="Apontamentos">
    <METHOD NAME="Listar" DESCRIPTION="Lista de Apontamentos" VERSION="47" INTFTYPE="5" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="Contrato" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="3" FIELDLABEL="Contrato" CTAB="0"/>
        <PARAM NAME="Cliente" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="1" LOOKUP="CLIENTES.LISTAR" LOOKUPKEY="Id" LOOKUPDISPLAY="Nome" LOOKUPCODE="CNPJCPF" FIELDLABEL="Cliente" CTAB="0"/>
        <PARAM NAME="Cooperado" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="4" LOOKUP="COOPERADOS.LISTAR" LOOKUPKEY="Id" LOOKUPDISPLAY="Nome" LOOKUPCODE="Matricula" FIELDLABEL="Cooperado" CTAB="0"/>
        <PARAM NAME="Veiculo" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="2" FIELDLABEL="Veiculo" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="Id" FORMAT="+" SIZE="8" FLAGS="1024" PROJECTION="0" FIELDLABEL="Id" CTAB="0"/>
        <FIELD NAME="OrdemServico" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="15" FIELDLABEL="Ordem Servi&#231;o" CTAB="0"/>
        <FIELD NAME="Contrato" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="14" FIELDLABEL="Contrato" CTAB="0"/>
        <FIELD NAME="Cooperado" SIZE="100" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Cooperado" CTAB="0"/>
        <FIELD NAME="Veiculo" SIZE="100" FLAGS="1" PROJECTION="0" ORDER="16" FIELDLABEL="Ve&#237;culo" CTAB="0"/>
        <FIELD NAME="DataEntrada" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Data Entrada" CTAB="0"/>
        <FIELD NAME="HoraEntrada" SIZE="5" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Hora Entrada" CTAB="0"/>
        <FIELD NAME="KmInicial" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="11" FIELDLABEL="Km Inicio" CTAB="0"/>
        <FIELD NAME="DataSaida" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Data Saida" CTAB="0"/>
        <FIELD NAME="HoraSaida" SIZE="5" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Hora Saida" CTAB="0"/>
        <FIELD NAME="KmFinal" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="12" FIELDLABEL="Km Fim" CTAB="0"/>
        <FIELD NAME="IntervaloDescanso" SIZE="5" FLAGS="1" PROJECTION="0" ORDER="13" FIELDLABEL="Intervalo" CTAB="0"/>
        <FIELD NAME="Viagem" FORMAT="B" SIZE="1" FLAGS="17" PROJECTION="0" ORDER="17" FIELDLABEL="Viagem" CTAB="0"/>
        <FIELD NAME="Reembolsos" FORMAT="M" SIZE="17" FLAGS="1" DECIMALS="4" PROJECTION="0" ORDER="18" FIELDLABEL="Reembolsos" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT A.Id,
       CP.Nome as Cooperado,
       A.OrdemServico,
       CT.Numero AS Contrato,
       VI.Modelo as Veiculo,
       A.DataEntrada,
       A.HoraEntrada,
       A.KmInicial,
       A.DataSaida,
       A.HoraSaida,
       A.KmFinal,
       A.IntervaloDescanso,
       A.Viagem,
       (SELECT SUM(Valor) FROM ApontamentosReembolsos R WHERE R.Apontamento = A.Id ) as Reembolsos
FROM Apontamentos A
INNER JOIN Cooperados CP ON (CP.Id =  A.Cooperado)
INNER JOIN Contratos CT ON (CT.Id = A.Contrato)
INNER JOIN Veiculos VI ON (VI.Id = A.Veiculo)
ORDER BY DataEntrada
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>