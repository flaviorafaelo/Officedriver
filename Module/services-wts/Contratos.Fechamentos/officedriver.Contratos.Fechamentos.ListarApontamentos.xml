<?xml version="1.0"?>
<root>
  <OBJECT NAME="Contratos.Fechamentos">
    <METHOD NAME="ListarApontamentos" DESCRIPTION="" VERSION="30" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="Fechamento" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Fechamento" CTAB="0"/>
        <PARAM NAME="Contrato" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Contrato" CTAB="0"/>
        <PARAM NAME="Produto" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Funcao" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="Fechamento" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" FIELDLABEL="Fechamento" CTAB="0"/>
        <FIELD NAME="Apontamentos" FORMAT="R" FLAGS="1" PROJECTION="0" FIELDLABEL="Apontamentos" NESTEDNAME="OFFICEDRIVER.CONTRATOS.FECHAMENTOS.APONTAMENTO" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT F.Id as Fechamento
       #ROWSET({SELECT:Apontamentos Ap.*
                FROM FechamentosContratos Fc
                INNER JOIN ContratosCooperados Cp ON (Cp.Contrato = Fc.Contrato) AND
                                                    (Cp.Produto = :Produto)
                INNER JOIN Apontamentos AP ON (Ap.Fechamento = Fc.Fechamento) AND
                                              (Ap.Contrato = Fc.Contrato) AND
                                              (Ap.Cooperado = Cp.Cooperado)
                Where Fc.Fechamento=:Fechamento AND
                      Fc.Contrato=:Contrato
                Order by  Ap.Cooperado, Ap.DataEntrada })
FROM Fechamentos F
WHERE Id=:Fechamento





</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>