<?xml version="1.0"?>
<root>
  <OBJECT NAME="Contratos.Fechamentos">
    <METHOD NAME="Excluir" DESCRIPTION="" VERSION="60" INTFTYPE="3" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="Id" FORMAT="+" SIZE="8" FLAGS="1024" PROJECTION="0" FIELDLABEL="Id" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>DELETE FROM Fechamentos WHERE Id=:id;
DELETE FROM FechamentosContratos WHERE Fechamento=:Id;

UPDATE  ApontamentosDetalhados SET Evento = Null
WHERE exists ( select 1 from FechamentosEventos e where e.id = ApontamentosDetalhados.Evento and e.Fechamento = :Id);

DELETE FROM FechamentosEventos WHERE Fechamento=:Id;
UPDATE Apontamentos SET Fechamento = null WHERE Fechamento=:Id;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>