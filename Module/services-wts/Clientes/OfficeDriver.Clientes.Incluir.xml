<?xml version="1.0"?>
<root>
  <OBJECT NAME="Clientes">
    <METHOD NAME="Incluir" DESCRIPTION="" VERSION="18" INTFTYPE="1" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
          <GROUP NAME="Contatos"/>
          <GROUP NAME="Contratos" STYLE="1"/>
          <GROUP NAME="Ve&#237;culos" STYLE="1"/>
          <GROUP NAME="Endere&#231;os"/>
        </GROUPS>
        <PARAM NAME="Nome" SIZE="100" FLAGS="1" PROJECTION="0" ORDER="1" FIELDLABEL="Nome" CTAB="0"/>
        <PARAM NAME="TipoPessoa" SIZE="1" FLAGS="1" DEFAULT="J" PROJECTION="0" ORDER="2" LOOKUP="list:'F','F&#237;sica';'J','Jur&#237;dica';" FIELDLABEL="Tipo de Pessoa" CTAB="0"/>
        <PARAM NAME="CPF" SIZE="14" FLAGS="1" PROJECTION="0" ORDER="3" FIELDLABEL="Cpf" CTAB="0"/>
        <PARAM NAME="CNPJ" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="4" FIELDLABEL="Cnpj" CTAB="0"/>
        <PARAM NAME="Logo" FORMAT="I" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="Logo" CTAB="0"/>
        <PARAM NAME="Endereco" FORMAT="R" FLAGS="1" PROJECTION="0" ORDER="13" FIELDLABEL="Endere&#231;os" NESTEDNAME="OfficeDriver.Pessoas.Endereco" GROUPNAME="Endere&#231;os" CTAB="0"/>
        <PARAM NAME="Contatos" FORMAT="R" FLAGS="1" STYLE="8" PROJECTION="0" ORDER="7" FIELDLABEL="Contatos" NESTEDNAME="OfficeDriver.Pessoas.Contato" GROUPNAME="Contatos" CTAB="0"/>
        <PARAM NAME="Veiculos" FORMAT="R" FLAGS="1" PROJECTION="0" ORDER="11" LOOKUP="OFFICEDRIVER.VEICULOS.LISTAR" FIELDLABEL="Veiculos" NESTEDNAME="OfficeDriver.Veiculos.Veiculo" GROUPNAME="Ve&#237;culos" CTAB="0"/>
        <PARAM NAME="Contratos" FORMAT="R" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Contratos" NESTEDNAME="OfficeDriver.Contratos.Contrato" GROUPNAME="Contratos" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="Id" FORMAT="+" SIZE="8" FLAGS="1024" PROJECTION="0" ORDER="1" FIELDLABEL="Id" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>#CHECK("SELECT COUNT(ID) AS N FROM CLIENTES WHERE CNPJ_CPF=:CPF OR CNPJ_CPF=:CNPJ", N>0, "J&#225; existe um cliente com o CNPJ/CPF informado.");

INSERT:CLI INTO CLIENTES( NOME, TIPOPESSOA, CPF, CNPJ, LOGO)
             VALUES ( :NOME, :TIPOPESSOA, :CPF, :CNPJ, :LOGO)
             #RETURN (ID);

INSERT INTO ENDERECOS ( TIPOPESSOA, PESSOA, CEP, LOGRADOURO, NUMERO, COMPLEMENTO, BAIRRO, ESTADO, CIDADE )
               VALUES ( 1, CLI.ID, :ENDERECO.CEP, :ENDERECO.LOGRADOURO, :ENDERECO.NUMERO, :ENDERECO.COMPLEMENTO, :ENDERECO.BAIRRO, :ENDERECO.ESTADO, :ENDERECO.CIDADE )
               #RETURN(ID);

#EACH() CONTATOS;
  INSERT INTO CONTATOS ( TIPOPESSOA, PESSOA, NOME, TIPO, DDD, TELEFONE, EMAIL)
                 VALUES ( 1,  CLI.ID, :CONTATOS.NOME, :CONTATOS.TIPO, :CONTATOS.DDD, :CONTATOS.TELEFONE, :CONTATOS.EMAIL)
                 #RETURN(ID);

#EACH() VEICULOS;
  INSERT INTO VEICULOSPESSOAS ( TIPOPESSOA, PESSOA, VEICULO)
                 VALUES ( 1,  CLI.ID, :VEICULOS.ID)
                 #RETURN(ID);

#EACH() CONTRATOS;
  INSERT INTO CLIENTESCONTRATOS ( CLIENTE, CONTRATO)
                 VALUES (CLI.ID, :CONTRATOS.ID)
                 #RETURN(ID);
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>